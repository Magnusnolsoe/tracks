# Base image
FROM python:3.11

# Java packages
RUN apt-get update && \
    apt-get install -y wget default-jre-headless

# Scala packages
RUN apt-get update && apt-get install -y scala
# could use precise version if needed by using the next two lines instead
#RUN wget -q https://www.scala-lang.org/files/archive/scala-2.13.11.deb
#RUN dpkg -i scala-2.13.11.deb

# Setup Python virtual environment
ENV VIRTUAL_ENV=/opt/venv
RUN python -m venv $VIRTUAL_ENV
ENV PATH="$VIRTUAL_ENV/bin:$PATH"

# Install Python packages
RUN python -m pip install --upgrade pip && pip install \
    faker \
    pexpect \
    pytest \
    pytest-repeat \
    pytest-xdist

WORKDIR /app

# Copy teacher tests
# COPY *.py ./
COPY *.py /app/

# Copy student solutions
COPY *.scala /app/
RUN scalac /app/*.scala

# Run tests
#ENTRYPOINT ["py.test",  "--verbose",  "--color=yes"]
